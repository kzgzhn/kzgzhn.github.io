(this["webpackJsonpkaspi-vypiska"]=this["webpackJsonpkaspi-vypiska"]||[]).push([[0],{102:function(e,t){},116:function(e,t,n){},122:function(e,t){},123:function(e,t){},124:function(e,t){},125:function(e,t){},126:function(e,t){},128:function(e,t,n){"use strict";n.r(t);var r=n(20),s=n.n(r),a=n(104),c=n.n(a),o=(n(116),n(53));var u={"\u041f\u043e\u043a\u0443\u043f\u043a\u0430":["\u043f\u043e\u043a\u0443\u043f\u043a\u0430","\u043f\u043e\u043a\u0443\u043f\u043a\u0438","\u043f\u043e\u043a\u0443\u043f\u043e\u043a"],"\u041f\u0435\u0440\u0435\u0432\u043e\u0434":["\u043f\u0435\u0440\u0435\u0432\u043e\u0434","\u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0430","\u043f\u0435\u0440\u0435\u0432\u043e\u0434\u043e\u0432"],"\u041f\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435":["\u043f\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435","\u043f\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f","\u043f\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0439"],"\u0421\u043d\u044f\u0442\u0438\u0435":["\u0441\u043d\u044f\u0442\u0438\u0435","\u0441\u043d\u044f\u0442\u0438\u044f","\u0441\u043d\u044f\u0442\u0438\u0439"]},i=function(e){return new Intl.NumberFormat("kz").format(e).replace(",",".")},l=n(4);function d(e){var t=e.item,n=e.setGroup;console.log("GroupListItem.js: render");var r=function(e,t){return u[e]?u[e][(n=t)%10===1&&n%100!==11?0:n%10>=2&&n%10<=4&&(n%100<10||n%100>=20)?1:2]||"":e;var n};return Object(l.jsxs)("div",{className:"border-t border-b sm:border-l sm:border-r sm:rounded bg-white px-3 py-2 flex justify-between cursor-pointer h-20",onClick:function(){return n(t)},children:[Object(l.jsx)("div",{className:"flex items-center justify-center",children:Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:t.name}),Object(l.jsx)("div",{className:"text-sm text-gray-500 mt-1",children:t.types?t.types.map((function(e,t){return Object(l.jsxs)("span",{children:[t?", ":""," ",e.count," ",r(e.name,e.count)]},e.name)})):""})]})}),Object(l.jsxs)("div",{className:"flex flex-col justify-center",children:[Object(l.jsx)("span",{className:"block text-right",children:parseInt(t.sum)?i(t.sum):""}),parseInt(t.sum2)?Object(l.jsxs)("span",{className:"block text-right text-green-500 mt-1",children:["+",i(t.sum2)]}):""]})]})}var m=n(81),p=n.n(m),f=n(106),b=n(97),j=n(98),x=n(105),h=n.n(x);function v(e){var t=e.setData,n=e.dataExists;console.log("UploadButton.js: render");var s=function(){var e=Object(b.a)(p.a.mark((function e(n){var r,s,a,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getDocument(n).promise;case 2:return r=e.sent,e.next=5,Promise.all(Object(f.a)(Array(r.numPages).keys()).map(function(){var e=Object(b.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getPage(t+1);case 2:return n=e.sent,e.next=5,n.getTextContent();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:s=e.sent,a=s.map((function(e){return Object.values(e.items.reduce((function(e,t){var n=t.transform[5];return(e[n]=e[n]||[]).push(t.str.trim()),e}),{}))})),c=(c=(c=(c=a.flat()).map((function(e){return 8===e.length&&e.shift(),e}))).filter((function(e){return 7===e.length&&"".concat(e[0]).match(/^\d{2}\.\d{2}\.\d{2}$/)}))).map((function(e){var t=new Date(e[0].replace(/(\d{2})\.(\d{2})\.(\d{2})/,"20$3-$2-$1")),n=e[2],r=e[4],s=e[6].replace("  "," "),a=s.replace(/^([^ ]+) [^ ]+ ([^ ]+\.)$/,"$1 $2"),c=n.match(/^(\+|-) (.*?) \u20b8$/);return{date:t,sum:n={raw:n,type:c[1],sum:parseFloat(c[2].replace(" ","").replace(",","."))},type:r,descr:a,descrRaw:s}})),t(c);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a=Object(r.useRef)();return Object(r.useEffect)((function(){var e=function(){a.current.click()};return document.addEventListener("open-upload-dialog",e,!1),function(){document.removeEventListener("open-upload-dialog",e,!1)}}),[]),Object(l.jsxs)("div",{className:n?"":"hidden",children:[Object(l.jsx)("button",{type:"button",className:"border bg-blue-500 hover:bg-blue-400 text-white py-2 px-3 rounded shadow",onClick:function(){return a.current.click()},children:n?"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0432\u044b\u043f\u0438\u0441\u043a\u0443":"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0432\u044b\u043f\u0438\u0441\u043a\u0443"}),Object(l.jsx)("input",{type:"file",ref:a,accept:".pdf",style:{display:"none"},onChange:function(e){var t=e.target.files[0];if(t){var n=new FileReader;n.onload=function(e){return s(new Uint8Array(e.target.result))},n.readAsArrayBuffer(t)}}})]})}j.GlobalWorkerOptions.workerSrc=h.a;var O=function(e){if(!e)return{items:null,minDate:null,maxDate:null,sum:null,sum2:null};var t,n,r=e.reduce((function(e,t){var n="_"+t.descr;return(e[n]=e[n]||[]).push(t),e}),{}),s=[],a=0,c=0;return Object.keys(r).forEach((function(e){var o=0,u=0,i={};r[e].forEach((function(e){"-"===e.sum.type&&(u+=e.sum.sum),"+"===e.sum.type&&(o+=e.sum.sum),i[e.type]||(i[e.type]=0),++i[e.type],(!t||t>e.date)&&(t=e.date),(!n||n<e.date)&&(n=e.date)}));var l=Object.keys(i).map((function(e){return{name:e,count:i[e]}}));a+=o,c+=u,function(e,t,n,r,a){s.push({id:e,name:t,sum:n,sum2:r,types:a})}(e,e.slice(1),u,o,l)})),{items:s=s.sort((function(e,t){return e.sum>t.sum?-1:e.sum<t.sum?1:e.sum2>t.sum2?-1:e.sum2<t.sum2?1:0})),minDate:t,maxDate:n,sum:a,sum2:c}},y=n(99),g=n(35),w=n(129),k=n(130),N=n(131);function D(e){var t=e.items;console.log("GroupListChart.js: render");var n=Object(r.useRef)();return Object(r.useEffect)((function(){if(t&&n.current){var e,r;t.forEach((function(t){(!e||e<t.date)&&(e=t.date),(!r||r>t.date)&&(r=t.date)}));var s=[],a=new Date(r);a.setDate(1);var c=new Date(e);for(c.setDate(1);a<=c;a.setMonth(a.getMonth()+1))s.push(new Date(a));var o=[];s.forEach((function(e){o.push(e.toISOString().slice(0,7))}));var u=[],i=[];o.forEach((function(e,n){t.forEach((function(t){e===t.date.toISOString().slice(0,7)&&(u[n]||(u[n]=0),i[n]||(i[n]=0),"+"===t.sum.type&&(u[n]+=t.sum.sum),"-"===t.sum.type&&(i[n]+=t.sum.sum))}))}));var l=u.map((function(e){return 0===e?"":e.toFixed(2).replace(".00","")})),d=i.map((function(e){return 0===e?"":e.toFixed(2).replace(".00","")})),m=[];d.some((function(e){return e}))&&m.push({data:d,type:"bar",label:{show:!0,position:"inside",rotate:90},showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)"},emphasis:{focus:"series"}}),l.some((function(e){return e}))&&m.push({data:l,type:"bar",label:{show:!0,position:"inside",rotate:90},showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)"},emphasis:{focus:"series"}}),g.b(n.current).setOption({xAxis:{type:"category",data:o,axisLabel:{interval:0,rotate:30}},yAxis:{type:"value"},series:m})}return function(){}}),[t]),Object(l.jsx)("div",{className:"-mt-8 px-3 sm:px-0 overflow-x-scroll",children:Object(l.jsx)("div",{ref:n,style:{height:"400px"}})})}function E(e){var t=e.minDate,n=e.maxDate,r=e.sum,s=e.sum2,a=function(e){return new Intl.DateTimeFormat("ru",{year:"numeric",month:"long",day:"numeric"}).format(e)};return Object(l.jsxs)("div",{className:"px-3 sm:px-0",children:[Object(l.jsxs)("span",{children:["\u0421","\xa0"+a(t).replace(" ","\xa0")+" ","\u043f\u043e","\xa0"+a(n).replace(" ","\xa0")+" "]}),s?" \u0440\u0430\u0441\u0445\u043e\u0434\u044b \u0441\u043e\u0441\u0442\u0430\u0432\u0438\u043b\u0438 "+i(s)+"\xa0\u0442\u0435\u043d\u0433\u0435":"",r?", \u0434\u043e\u0445\u043e\u0434\u044b "+i(r)+"\xa0\u0442\u0435\u043d\u0433\u0435":"",r||s?".":""]})}function S(e){var t=e.setGroup,n=e.data,s=e.setData;console.log("GroupList.js: render");var a=Object(r.useState)(),c=Object(o.a)(a,2),u=c[0],i=c[1],m=Object(r.useState)(),p=Object(o.a)(m,2),f=p[0],b=p[1],j=Object(r.useState)(),x=Object(o.a)(j,2),h=x[0],y=x[1],g=Object(r.useState)(),w=Object(o.a)(g,2),k=w[0],N=w[1],S=Object(r.useState)(),C=Object(o.a)(S,2),G=C[0],I=C[1];return Object(r.useEffect)((function(){if(n){var e=O(n);i(e.items),b(e.maxDate),y(e.minDate),N(e.sum),I(e.sum2)}}),[n]),Object(l.jsxs)("section",{children:[Object(l.jsxs)("div",{className:"mt-3 flex justify-between px-3 sm:px-0",children:[Object(l.jsx)("h1",{className:"text-white bg-red-500 py-2 px-3 rounded flex items-center",children:"\u041a\u0430\u0441\u043f\u0438 \u0432\u044b\u043f\u0438\u0441\u043a\u0430"}),Object(l.jsx)("div",{className:"flex items-center justify-center",children:Object(l.jsx)(v,{dataExists:n&&n.length,setData:s})})]}),Object(l.jsxs)("div",{className:"space-y-2 mt-5",children:[u?Object(l.jsx)(E,{minDate:h,maxDate:f,sum:k,sum2:G,items:n}):"",u?Object(l.jsx)(D,{items:n}):"",u?Object(l.jsx)("h2",{className:"font-bold text-3xl px-3 sm:px-0",children:"\u041f\u043e \u0433\u0440\u0443\u043f\u043f\u0430\u043c"}):"",u?u.map((function(e){return Object(l.jsx)(d,{item:e,setGroup:t},e.name)})):""]})]})}function C(e){var t=e.item;return console.log("GroupItem.js: render"),Object(l.jsxs)("div",{className:"border-t border-b sm:border-l sm:border-r sm:rounded bg-white px-3 py-2 flex justify-between ".concat("+"===t.sum.type?" text-green-500":""," "),children:[Object(l.jsx)("div",{className:"flex items-center justify-center",children:Object(l.jsx)("div",{children:Object(l.jsx)("h3",{children:t.date.toLocaleDateString()})})}),Object(l.jsx)("div",{className:"flex flex-col justify-center",children:t.sum.raw})]})}function G(e){var t=e.items;console.log("GroupItemChart.js: render");var n=Object(r.useRef)();return Object(r.useEffect)((function(){if(t&&n.current){var e,r;t.forEach((function(t){(!e||e<t.date)&&(e=t.date),(!r||r>t.date)&&(r=t.date)}));var s=[],a=new Date(r);a.setDate(1);var c=new Date(e);for(c.setDate(1);a<=c;a.setMonth(a.getMonth()+1))s.push(new Date(a));var o=[];s.forEach((function(e){o.push(e.toISOString().slice(0,7))}));var u=[],i=[];o.forEach((function(e,n){t.forEach((function(t){e===t.date.toISOString().slice(0,7)&&(u[n]||(u[n]=0),i[n]||(i[n]=0),"+"===t.sum.type&&(u[n]+=t.sum.sum),"-"===t.sum.type&&(i[n]+=t.sum.sum))}))}));var l=u.map((function(e){return 0===e?"":e.toFixed(2).replace(".00","")})),d=i.map((function(e){return 0===e?"":e.toFixed(2).replace(".00","")})),m=[];d.some((function(e){return e}))&&m.push({data:d,type:"bar",label:{show:!0,position:"inside",rotate:90},showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)"},emphasis:{focus:"series"}}),l.some((function(e){return e}))&&m.push({data:l,type:"bar",label:{show:!0,position:"inside",rotate:90},showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)"},emphasis:{focus:"series"}}),g.b(n.current).setOption({xAxis:{type:"category",data:o,axisLabel:{interval:0,rotate:30}},yAxis:{type:"value"},series:m})}return function(){}}),[t]),Object(l.jsx)("div",{className:"-mt-8 px-3 sm:px-0 overflow-x-scroll",children:Object(l.jsx)("div",{ref:n,style:{height:"400px"}})})}function I(e){var t=e.group,n=e.resetGroup,s=e.items;return console.log("Group.js: render"),Object(r.useEffect)((function(){var e=function(e){27!==e.keyCode&&8!==e.keyCode||n()};return document.addEventListener("keydown",e,!1),function(){document.removeEventListener("keydown",e,!1)}}),[t,n]),Object(r.useEffect)((function(){return t&&(document.body.style.overflow="hidden"),function(){document.body.style.overflow="auto"}}),[t]),s&&t?Object(l.jsx)("div",{className:"fixed bg-gray-100 overflow-y-auto z-10 inset-0",children:Object(l.jsx)("div",{className:"max-w-screen-sm mx-auto",children:Object(l.jsxs)("div",{className:"mt-4",children:[Object(l.jsx)("p",{className:"px-3 sm:px-0",children:Object(l.jsx)("span",{className:"bg-blue-500 hover:bg-blue-400 text-white px-3 py-2 rounded cursor-pointer",onClick:n,children:"\u2190 \u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435 \u0433\u0440\u0443\u043f\u043f\u044b"})}),Object(l.jsx)("div",{className:"bg-gray-100 my-3 px-3 sm:px-0 mt-7",children:Object(l.jsx)("h3",{className:"font-bold text-4xl",children:t.name})}),Object(l.jsx)(G,{items:s}),Object(l.jsx)("section",{className:"space-y-1 mb-5",children:s.map((function(e,t){return Object(l.jsx)(C,{item:e},e.date.toLocaleString()+t)}))})]})})}):null}function L(){var e=Object(r.useState)(),t=Object(o.a)(e,2),n=t[0],s=t[1],a=Object(r.useState)(),c=Object(o.a)(a,2),u=c[0],i=c[1];return console.log("App.js: render"),Object(l.jsxs)("main",{children:[Object(l.jsx)(S,{data:n,setData:s,setGroup:i}),Object(l.jsx)(I,{group:u,resetGroup:function(){return i(null)},items:n&&u?n.filter((function(e){return e.descr===u.name})):[]}),Object(l.jsx)("div",{className:"grid place-content-center h-96",children:Object(l.jsx)("button",{type:"button",className:"border bg-blue-500 hover:bg-blue-400 text-white py-6 px-14 rounded shadow",onClick:function(){return document.dispatchEvent(new Event("open-upload-dialog"))},children:n?"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0432\u044b\u043f\u0438\u0441\u043a\u0443":"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0432\u044b\u043f\u0438\u0441\u043a\u0443"})})]})}y.a([w.a,k.a,N.a]),y.a([w.a,k.a,N.a]);var F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,132)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),r(e),s(e),a(e),c(e)}))};c.a.render(Object(l.jsx)(s.a.StrictMode,{children:Object(l.jsx)(L,{})}),document.getElementById("root")),F()}},[[128,1,2]]]);
//# sourceMappingURL=main.30268777.chunk.js.map